 --- Units Table ----
-- TODO: add maintanence and service logs
-- TODO: add trouble codes lookup and logging
--create database carData; 
drop table "Unit" cascade;
create table if not exists "Unit" (
	"UnitID" VARCHAR(5) NOT NULL PRIMARY KEY,
	"UnitName" VARCHAR(45) NOT NULL unique,
	"IsSI" boolean not NULL,
	"Dimension" VARCHAR(45) not null,
	"ConversionMultiplier" double precision null,
	"ConversionAdder" double precision null
);

insert into "Unit"("UnitID", "UnitName", "IsSI", "Dimension", "ConversionMultiplier", "ConversionAdder")
values('L','liter',true, 'L^3',null,null),
	('gal','Gallon',false, 'L^3',3.7854, null),
	('m','meter',true,'L', null,null),
	('cm','centimeter',false, 'L',.001, null),
	('in','inch',false,'L', 0.0254, null),
	('-','dimensionless',true,'-',null,null),
	('%','percent',false,'-',.001,null),
	('°C','degree celsius',false,'θ',1,273.15),
	('°F','degree Fahrenheit',false,'θ',5/9,241.15),
	('K','Kelvin',true,'θ',null,null),
	('Pa','pascal',true,'M/(LT^2)',null,null),
	('kPa','kilopascal',false,'M/(LT^2)',1000,null),
	('rad','radian',true,'-',null,null),
	('°','degree',false,'-',0.0174553,null),
	('°/s','degrees per second',false,'T^-1',0.0174553,null),
	('rad/s','radians per second',true,'T^-1',null,null),
	('kg/s','kilograms per second',true,'M/T',null,null),
	('g/s','grams per second',false,'M/T',0.001,null),
	('rpm','revolutions per minute',false,'T^-1',0.01667,null),
	('rps','revolutions per second',true,'T^-1',null,null),
	('s','second',true,'T',null,null),
	('min','minute',false,'T',0.016667,null),
	('h','hour',false,'T',0.000277778,null),
	('day','day',false,'T',0.0000115740740741,null),
	('km','kilometer',false,'L',0.001, null),
    ('mi','mile',false,'L',1609.344, null),
	('hm','hectometer',false,'L',0.01,null),
	('m/s','meters per second',true,'L/T',null,null),
	('km/h','kilometers per hour',false,'L/T',0.2777778,null),
	('V','volt',true,'ML^2/(T^3I)',null,null),
	('A','amphere',true,'I',null,null),
	('mA','milli-amphere',false,'I',0.001,null),
	('L/h','liters per hour',false,'L^3/T',0.00027778,null),
	('L/s','liters per second',true,'L^3/T',null,null),
	('N','newton',true,'ML/T^2',null,null),
	('Nm','newton-meter',true,'ML^2/T^2',null,null),
	('kg/h','kilograms per hour',false,'M/T',0.0002777778,null),
	('ppm','parts per million',false,'-',0.000001,null),
	('mg','milligram',false,'M',100000,null),
	('mg/sr','milligrams per stroke',false,'M',100000,null),
	('kg/sr','kilograms per stroke',true,'M',null,null),
	('ms','millisecond',false,'T',0.001,null),
	('m/s2','meters per second squared',true,'L/T^2',null,null),
	('gacc','g',false,'L/T^2',9.80665,null),
	('T','Tesla',true,'M/(T^2I)',null,null),
	('μT','microtesla',false,'M/(T^2I)',0.000001,null);
	--- Car  ---
drop table "Car" cascade;
create table "Car" (
	"VIN" char(17) not null primary key,
	"Year" INT not null,
	"Make" varchar(45) not null,
	"Model" varchar(45) not null,
	"TireDiameter" double precision null,
	"TireDiameterUnitID" varchar(5) null references "Unit"("UnitID"),
	"FuelTankCapacity" double precision null,
	"FuelTankCapacityUnitID" varchar(5) null references "Unit"("UnitID")
);


---OBD services ---
drop table "OBD_Service" cascade;
create table "OBD_Service"(
	"OBD_Service" smallint not null primary key,
	"ODB_ServiceMode" varchar(100) not null
);
insert into "OBD_Service"
values  (0, 'Freematics external current data'),
	(1,'Show current data'),
	(2,'Show freeze frame data'),
	(3,'Show Stored Diagnostic Trouble Codes'),
	(4,'Clear Diagnostic Trouble Codes'),
	(5,'Test results, oxygen sensor monitoring (non-CAN)'),
	(6,'Test results, other component/system monitoring (CAN)'),
	(7,'Show pending Diagnostic Trouble Codes'),
	(8,'Control operation of on-board component'),
	(9,'Request Vehicle information'),
	(x'0A'::int,'Permenant Diagnostic Trouble Codes');

--- PID ---
drop table "Parameter" cascade;
create table "Parameter"(
	"PID" smallint not null , 
	"OBD_Service" smallint not null references "OBD_Service"("OBD_Service"),
	"bytesOfData" smallint not null,
	"ParameterName" varchar(200) not null,
	primary key("PID", "OBD_Service")
);
insert into "Parameter"("PID", "bytesOfData", "OBD_Service", "ParameterName")
values  (0,4,0,'System time (logger)'),
	(10,3,0,'Latitude'),
	(11,3,0,'Longitude'),
	(12,2,0,'Altitude (m)'),
	(13,1,0,'Speed (km/h)'),
	(14,1,0,'Course (degree)'),
	(15,1,0,'Number of satellites in use'),
	(16,3,0,'UTC Time (HHMMSSmm)'),
	(17,3,0,'UTC Date (DDMMYY)'),
	(32,6,0,'Accelerometer data (x:y:z)'),
	(33,6,0,'Gyroscope data (x:y:z)'),
	(34,6,0,'Magnitude field data (x/y/z)'),
	(35,2,0,'MEMS temperature (in 0.1 Celsius degree)'),
	(36,2,0,'Battery voltage (in 0.01V)'),
	(37,-1,0,'Orientation data  (yaw/pitch/roll)'),
	(129,-1,0,'Cellular network signal level (dB)'),
	(130,-1,0,'CPU temperature (in 0.1 Celsius degree)'),
	(131,-1,0,'CPU hall sensor data'),
	(0,4,1,'PIDs supported [01 - 20] '),
	(1,4,1,'Monitor status since DTCs cleared. '),
	(2,2,1,'Freeze DTC '),
	(3,2,1,'Fuel system status '),
	(4,1,1,'Calculated engine load '),
	(5,1,1,'Engine coolant temperature '),
	(6,1,1,'Short term fuel trim—Bank 1 '),
	(7,1,1,'Long term fuel trim—Bank 1 '),
	(8,1,1,'Short term fuel trim—Bank 2 '),
	(9,1,1,'Long term fuel trim—Bank 2 '),
	(10,1,1,'Fuel pressure (gauge pressure) '),
	(11,1,1,'Intake manifold absolute pressure '),
	(12,2,1,'Engine RPM '),
	(13,1,1,'Vehicle speed '),
	(14,1,1,'Timing advance '),
	(15,1,1,'Intake air temperature '),
	(16,2,1,'MAF air flow rate '),
	(17,1,1,'Throttle position '),
	(18,1,1,'Commanded secondary air status '),
	(19,1,1,'Oxygen sensors present (in 2 banks) '),
	(20,2,1,'Oxygen Sensor 1'),
	(21,2,1,'Oxygen Sensor 2'),
	(22,2,1,'Oxygen Sensor 3'),
	(23,2,1,'Oxygen Sensor 4'),
	(24,2,1,'Oxygen Sensor 5'),
	(25,2,1,'Oxygen Sensor 6'),
	(26,2,1,'Oxygen Sensor 7'),
	(27,2,1,'Oxygen Sensor 8'),
	(28,1,1,'OBD standards this vehicle conforms to '),
	(29,1,1,'Oxygen sensors present (in 4 banks) '),
	(30,1,1,'Auxiliary input status '),
	(31,2,1,'Run time since engine start '),
	(32,4,1,'PIDs supported [21 - 40] '),
	(33,2,1,'Distance traveled with malfunction indicator lamp (MIL) on '),
	(34,2,1,'Fuel Rail Pressure (relative to manifold vacuum) '),
	(35,2,1,'"Fuel Rail Gauge Pressure (diesel, or gasoline direct injection) "'),
	(36,4,1,'Oxygen Sensor 1'),
	(37,4,1,'Oxygen Sensor 2'),
	(38,4,1,'Oxygen Sensor 3'),
	(39,4,1,'Oxygen Sensor 4'),
	(40,4,1,'Oxygen Sensor 5'),
	(41,4,1,'Oxygen Sensor 6'),
	(42,4,1,'Oxygen Sensor 7'),
	(43,4,1,'Oxygen Sensor 8'),
	(44,1,1,'Commanded EGR '),
	(45,1,1,'EGR Error '),
	(46,1,1,'Commanded evaporative purge '),
	(47,1,1,'Fuel Tank Level Input '),
	(48,1,1,'Warm-ups since codes cleared '),
	(49,2,1,'Distance traveled since codes cleared '),
	(50,2,1,'Evap. System Vapor Pressure '),
	(51,1,1,'Absolute Barometric Pressure '),
	(52,4,1,'Oxygen Sensor 1'),
	(53,4,1,'Oxygen Sensor 2'),
	(54,4,1,'Oxygen Sensor 3'),
	(55,4,1,'Oxygen Sensor 4'),
	(56,4,1,'Oxygen Sensor 5'),
	(57,4,1,'Oxygen Sensor 6'),
	(58,4,1,'Oxygen Sensor 7'),
	(59,4,1,'Oxygen Sensor 8'),
	(60,2,1,'Catalyst Temperature: Bank 1, Sensor 1'),
	(61,2,1,'Catalyst Temperature: Bank 2, Sensor 1'),
	(62,2,1,'Catalyst Temperature: Bank 1, Sensor 2'),
	(63,2,1,'Catalyst Temperature: Bank 2, Sensor 2'),
	(64,4,1,'PIDs supported [41 - 60]'),
	(65,4,1,'Monitor status this drive cycle'),
	(66,2,1,'Control module voltage '),
	(67,2,1,'Absolute load value '),
	(68,2,1,'Fuel–Air commanded equivalence ratio '),
	(69,1,1,'Relative throttle position '),
	(70,1,1,'Ambient air temperature '),
	(71,1,1,'Absolute throttle position B '),
	(72,1,1,'Absolute throttle position C '),
	(73,1,1,'Accelerator pedal position D '),
	(74,1,1,'Accelerator pedal position E '),
	(75,1,1,'Accelerator pedal position F '),
	(76,1,1,'Commanded throttle actuator '),
	(77,2,1,'Time run with MIL on '),
	(78,2,1,'Time since trouble codes cleared '),
	(79,4,1,'Maximum value for Fuel–Air equivalence ratio, oxygen sensor voltage, oxygen sensor current, and intake manifold absolute pressure'),
	(80,4,1,'Maximum value for air flow rate from mass air flow sensor'),
	(81,1,1,'Fuel Type '),
	(82,1,1,'Ethanol fuel % '),
	(83,2,1,'Absolute Evap system Vapor Pressure '),
	(84,2,1,'Evap system vapor pressure '),
	(85,2,1,'Short term secondary oxygen sensor trim, A: bank 1, B: bank 3'),
	(86,2,1,'Long term secondary oxygen sensor trim, A: bank 1, B: bank 3'),
	(87,2,1,'Short term secondary oxygen sensor trim, A: bank 2, B: bank 4'),
	(88,2,1,'Long term secondary oxygen sensor trim, A: bank 2, B: bank 4' ),
	(89,2,1,'Fuel rail absolute pressure '),
	(90,1,1,'Relative accelerator pedal position '),
	(91,1,1,'Hybrid battery pack remaining life '),
	(92,1,1,'Engine oil temperature '),
	(93,2,1,'Fuel injection timing '),
	(94,2,1,'Engine fuel rate '),
	(95,1,1,'Emission requirements to which vehicle is designed '),
	(96,4,1,'PIDs supported [61 - 80] '),
	(97,1,1,'Drivers demand engine - percent torque '),
	(98,1,1,'Actual engine - percent torque '),
	(99,2,1,'Engine reference torque '),
	(100,5,1,'Engine percent torque data '),
	(101,2,1,'Auxiliary input / output supported '),
	(102,5,1,'Mass air flow sensor '),
	(103,3,1,'Mass air flow sensor '),
	(104,7,1,'Intake air temperature sensor '),
	(105,7,1,'Commanded EGR and EGR Error '),
	(106,5,1,'Commanded Diesel intake air flow control and relative intake air flow position '),
	(107,5,1,'Exhaust gas recirculation temperature '),
	(108,5,1,'Commanded throttle actuator control and relative throttle position '),
	(109,6,1,'Fuel pressure control system '),
	(110,5,1,'Injection pressure control system '),
	(111,3,1,'Turbocharger compressor inlet pressure '),
	(112,9,1,'Boost pressure control '),
	(113,5,1,'Variable Geometry turbo (VGT) control '),
	(114,5,1,'Wastegate control '),
	(115,5,1,'Exhaust pressure '),
	(116,5,1,'Turbocharger RPM '),
	(117,7,1,'Turbocharger temperature '),
	(118,7,1,'Turbocharger temperature '),
	(119,5,1,'Charge air cooler temperature (CACT) '),
	(120,9,1,'Exhaust Gas temperature (EGT) Bank 1 '),
	(121,9,1,'Exhaust Gas temperature (EGT) Bank 2 '),
	(122,7,1,'Diesel particulate filter (DPF) '),
	(123,7,1,'Diesel particulate filter (DPF) '),
	(124,9,1,'Diesel Particulate filter (DPF) temperature '),
	(125,1,1,'NOx NTE (Not-To-Exceed) control area status '),
	(126,1,1,'PM NTE (Not-To-Exceed) control area status '),
	(127,13,1,'Engine run time '),
	(128,4,1,'PIDs supported [81 - A0] '),
	(129,21,1,'Engine run time for Auxiliary Emissions Control Device(AECD) '),
	(130,21,1,'Engine run time for Auxiliary Emissions Control Device(AECD) '),
	(131,5,1,'NOx sensor '),
	(132,1,1,'Manifold surface temperature '),
	(133,10,1,'NOx reagent system '),
	(134,5,1,'Particulate matter (PM) sensor '),
	(135,5,1,'Intake manifold absolute pressure '),
	(136,13,1,'SCR Induce System '),
	(137,41,1,'Run Time for AECD #11-#15 '),
	(138,41,1,'Run Time for AECD #16-#20 '),
	(139,7,1,'Diesel Aftertreatment '),
	(140,16,1,'O2 Sensor (Wide Range) '),
	(141,1,1,'Throttle Position G '),
	(142,1,1,'Engine Friction - Percent Torque '),
	(143,5,1,'PM Sensor Bank 1 & 2 '),
	(144,3,1,'WWH-OBD Vehicle OBD System Information '),
	(145,5,1,'WWH-OBD Vehicle OBD System Information '),
	(146,2,1,'Fuel System Control '),
	(147,3,1,'WWH-OBD Vehicle OBD Counters support '),
	(148,12,1,'NOx Warning And Inducement System '),
	(152,9,1,'Exhaust Gas Temperature Sensor '),
	(153,9,1,'Exhaust Gas Temperature Sensor '),
	(154,6,1,'Hybrid/EV Vehicle System Data, Battery, Voltage'),
	(155,4,1,'Diesel Exhaust Fluid Sensor Data '),
	(156,17,1,'O2 Sensor Data '),
	(157,4,1,'Engine Fuel Rate '),
	(158,2,1,'Engine Exhaust Flow Rate '),
	(159,9,1,'Fuel System Percentage Use '),
	(160,4,1,'PIDs supported [A1 - C0] '),
	(161,9,1,'NOx Sensor Corrected Data '),
	(162,2,1,'Cylinder Fuel Rate '),
	(163,9,1,'Evap System Vapor Pressure '),
	(164,4,1,'Transmission Actual Gear '),
	(165,4,1,'Diesel Exhaust Fluid Dosing '),
	(166,4,1,'Odometer '),
	(192,4,1,'PIDs supported [C1 - E0] '),
	(0,4,9,'Service 9 supported PIDs (01 to 20) '),
	(1,1,9,'VIN Message Count in PID 02. Only for ISO 9141-2, ISO 14230-4 and SAE J1850.'),
	(2,17,9,'Vehicle Identification Number (VIN) '),
	(3,1,9,'Calibration ID message count for PID 04. Only for ISO 9141-2, ISO 14230-4 and SAE J1850.'),
	(4,16,9,'Calibration ID '),
	(5,1,9,'Calibration verification numbers (CVN) message count for PID 06. Only for ISO 9141-2, ISO 14230-4 and SAE J1850.'),
	(6,16,9,'Calibration Verification Numbers (CVN) Several CVN can be output (4 bytes each) the number of CVN and CALID must match '),
	(7,1,9,'In-use performance tracking message count for PID 08 and 0B. Only for ISO 9141-2, ISO 14230-4 and SAE J1850.'),
	(8,4,9,'In-use performance tracking for spark ignition vehicles '),
	(9,1,9,'ECU name message count for PID 0A '),
	(10,20,9,'ECU name '),
	(11,4,9,'In-use performance tracking for compression ignition vehicles ');

--- PID byte ---
drop table "Parameter_Byte" cascade;
create table "Parameter_Byte"(
	"PID"	smallint not null,
	"OBD_Service" smallint not null,
	"byteStart" smallint not null,
	"wordLength" smallint not null,
	"PID_byteDescription" varchar(200) null,
	"MinValue" double precision null,
	"MaxValue" double precision null,
	"UnitID" varchar(5) null references "Unit"("UnitID"),
	"Multiplier" double precision null,
	"adder"   double precision null,
	primary key("PID", "OBD_Service", "byteStart"),
	Constraint "FK_Parameter_Byte_Parameter" FOREIGN KEY ("PID", "OBD_Service")
		References "Parameter" ("PID", "OBD_Service")
);

insert into "Parameter_Byte"
values  (0,1,0,4,null,null,null,null,null),
	(1,1,0,4,null,null,null,null,null),
	(2,1,0,2,null,null,null,null,null),
	(3,1,0,2,null,null,null,null,null),
	(4,1,0,1,null,0,1,'-',0.00392157),
	(5,1,0,1,null,-40,215,'°C',1),
	(6,1,0,1,null,-1,0.992,'-',0.0078125),
	(7,1,0,1,null,-1,0.992,'-',0.0078125),
	(8,1,0,1,null,-1,0.992,'-',0.0078125),
	(9,1,0,1,null,-1,0.992,'-',0.0078125),
	(10,1,0,1,null,0,765,'kPa',3),
	(11,1,0,1,null,0,255,'kPa',1),
	(12,1,0,2,null,0,16383.75,'rpm',0.25),
	(13,1,0,1,null,0,255,'km/h',1),
	(14,1,0,1,null,-64,63.5,'°',0.5),
	(15,1,0,1,null,-40,215,'°C',1),
	(16,1,0,2,null,0,655.35,'g/s',0.01),
	(17,1,0,1,null,0,1,'-',0.00392157),
	(18,1,0,1,null,null,null,null,null),
	(19,1,0,1,null,null,null,null,null),
	(20,1,0,1,'Voltage',0,1.275,'V',0.005),
	(20,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(21,1,0,1,'Voltage',0,1.275,'V',0.005),
	(21,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(22,1,0,1,'Voltage',0,1.275,'V',0.005),
	(22,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(23,1,0,1,'Voltage',0,1.275,'V',0.005),
	(23,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(24,1,0,1,'Voltage',0,1.275,'V',0.005),
	(24,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(25,1,0,1,'Voltage',0,1.275,'V',0.005),
	(25,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(26,1,0,1,'Voltage',0,1.275,'V',0.005),
	(26,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(27,1,0,1,'Voltage',0,1.275,'V',0.005),
	(27,1,1,1,'Short term fuel trim',-1,0.992,'-',0.0078125),
	(28,1,0,1,null,-1,0.992,'-',0.0078125),
	(29,1,0,1,null,null,null,null,null),
	(30,1,0,1,null,null,null,null,null),
	(31,1,0,2,null,0,65535,'s',1),
	(32,1,0,4,null,null,null,null,null),
	(33,1,0,2,null,0,65535,'km',1),
	(34,1,0,2,null,0,5177.265,'kPa',0.079),
	(35,1,0,2,null,0,655350,'kPa',10),
	(36,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(36,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(37,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(37,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(38,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(38,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(39,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(39,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(40,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(40,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(41,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(41,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(42,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(42,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(43,1,0,2,'Fuel- Air Equivalent ratio',0,2,'-',3.0517578125E-05),
	(43,1,2,2,'Voltage',0,8,'V',0.0001220703125),
	(44,1,0,1,null,0,1,'-',0.00392157),
	(45,1,0,1,null,-1,0.992,'-',0.00784314),
	(46,1,0,1,null,0,1,'-',0.00392157),
	(47,1,0,1,null,0,1,'-',0.00392157),
	(48,1,0,1,null,0,1,'-',1),
	(49,1,0,2,null,0,65535,'km',1),
	(50,1,0,2,null,-8192,8191.75,'Pa',0.25),
	(51,1,0,1,null,0,255,'kPa',1),
	(52,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(52,1,2,2,'Current',-128,128,'mA',0.00390625),
	(53,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(53,1,2,2,'Current',-128,128,'mA',0.00390625),
	(54,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(54,1,2,2,'Current',-128,128,'mA',0.00390625),
	(55,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(55,1,2,2,'Current',-128,128,'mA',0.00390625),
	(56,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(56,1,2,2,'Current',-128,128,'mA',0.00390625),
	(57,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(57,1,2,2,'Current',-128,128,'mA',0.00390625),
	(58,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(58,1,2,2,'Current',-128,128,'mA',0.00390625),
	(59,1,0,2,'Fuel – air equivalence ratio',0,2,'-',3.0517578125E-05),
	(59,1,2,2,'Current',-128,128,'mA',0.00390625),
	(60,1,0,2,null,-40,6513.5,'°C',0.1),
	(61,1,0,2,null,-40,6513.5,'°C',0.1),
	(62,1,0,2,null,-40,6513.5,'°C',0.1),
	(63,1,0,2,null,-40,6513.5,'°C',0.1),
	(64,1,0,4,null,null,null,null,null),
	(65,1,0,4,null,null,null,null,null),
	(66,1,0,2,null,0,65.535,'V',0.001),
	(67,1,0,2,null,0,25.7,'-',0.00392157),
	(68,1,0,2,null,0,2,'-',3.0517578125E-05),
	(69,1,0,1,null,0,1,'-',0.00392157),
	(70,1,0,1,null,-40,215,'°C',1),
	(71,1,0,1,null,0,1,'-',0.00392157),
	(72,1,0,1,null,1,2,'-',0.00392157),
	(73,1,0,1,null,2,3,'-',0.00392157),
	(74,1,0,1,null,3,4,'-',0.00392157),
	(75,1,0,1,null,4,5,'-',0.00392157),
	(76,1,0,1,null,5,6,'-',0.00392157),
	(77,1,0,2,null,0,65535,'min',1),
	(78,1,0,2,null,0,65535,'min',1),
	(79,1,0,1,'Maximum Fuel-air equivalence ratio',0,255,'-',1),
	(79,1,1,1,'Maximum Oxygen sensor voltage',0,255,'V',1),
	(79,1,2,1,'Maximum Oxygen sensor current',0,255,'mA',1),
	(79,1,3,1,'Maximum intake manifold absolute pressure',0,2550,'kPa',1),
	(80,1,0,4,null,0,2550,'g/s',10),
	(81,1,0,1,null,null,null,null,null),
	(82,1,0,1,null,0,1,'-',0.00392157),
	(83,1,0,2,null,0,327.675,'kPa',0.005),
	(84,1,0,2,null,-32767,32768,'Pa',1),
	(85,1,0,1,'Bank 1',-1,0.992,'-',0.00784314),
	(85,1,1,1,'Bank 3',-1,0.992,'-',0.00784314),
	(86,1,0,1,'Bank 1',-1,0.992,'-',0.00784314),
	(86,1,1,1,'Bank 3',-1,0.992,'-',0.00784314),
	(87,1,0,1,'Bank 2',-1,0.992,'-',0.00784314),
	(87,1,1,1,'Bank 4',-1,0.992,'-',0.00784314),
	(88,1,0,1,'Bank 2',-1,0.992,'-',0.00784314),
	(89,1,1,1,'Bank 4',-1,0.992,'-',0.00784314),
	(89,1,0,2,null,0,655350,'kPa',10),
	(90,1,0,1,null,0,1,'-',0.00392157),
	(91,1,0,1,null,0,1,'-',0.00392157),
	(92,1,0,1,null,-40,210,'°C',1),
	(93,1,0,2,null,-210,301.992,'°',0.00784314),
	(94,1,0,2,null,0,3212.75,'L/h',0.05),
	(95,1,0,1,null,null,null,null,null),
	(96,1,0,4,null,null,null,null,null),
	(97,1,0,1,null,-1.25,1.3,'-',0.0078125),
	(98,1,0,1,null,-1.25,1.3,'-',0.0078125),
	(99,1,0,2,null,0,65535,'Nm',1),
	(100,1,0,1,'Idle',-1.25,1.3,'-',0.01),
	(100,1,1,1,'Engine Point 1',-1.25,1.3,'-',0.01),
	(100,1,2,1,'Engine Point 2',-1.25,1.3,'-',0.01),
	(100,1,3,1,'Engine Point 3',-1.25,1.3,'-',0.01),
	(100,1,4,1,'Engine Point 4',-1.25,1.3,'-',0.01),
	(101,1,0,2,null,null,null,null,null),
	(102,1,0,5,null,null,null,null,null),
	(103,1,0,3,null,null,null,null,null),
	(104,1,0,7,null,null,null,null,null),
	(105,1,0,7,null,null,null,null,null),
	(106,1,0,5,null,null,null,null,null),
	(107,1,0,5,null,null,null,null,null),
	(108,1,0,5,null,null,null,null,null),
	(109,1,0,6,null,null,null,null,null),
	(110,1,0,5,null,null,null,null,null),
	(111,1,0,3,null,null,null,null,null),
	(112,1,0,9,null,null,null,null,null),
	(113,1,0,5,null,null,null,null,null),
	(114,1,0,5,null,null,null,null,null),
	(115,1,0,5,null,null,null,null,null),
	(116,1,0,5,null,null,null,null,null),
	(117,1,0,7,null,null,null,null,null),
	(118,1,0,7,null,null,null,null,null),
	(119,1,0,5,null,null,null,null,null),
	(120,1,0,9,null,null,null,null,null),
	(121,1,0,9,null,null,null,null,null),
	(122,1,0,7,null,null,null,null,null),
	(123,1,0,7,null,null,null,null,null),
	(124,1,0,9,null,null,null,null,null),
	(125,1,0,1,null,null,null,null,null),
	(126,1,0,1,null,null,null,null,null),
	(127,1,0,13,null,null,null,null,null),
	(128,1,0,4,null,null,null,null,null),
	(129,1,0,21,null,null,null,null,null),
	(130,1,0,21,null,null,null,null,null),
	(131,1,0,5,null,null,null,null,null),
	(132,1,0,1,null,null,null,null,null),
	(133,1,0,10,null,null,null,null,null),
	(134,1,0,5,null,null,null,null,null),
	(135,1,0,5,null,null,null,null,null),
	(136,1,0,13,null,null,null,null,null),
	(137,1,0,41,null,null,null,null,null),
	(138,1,0,41,null,null,null,null,null),
	(139,1,0,7,null,null,null,null,null),
	(140,1,0,16,null,null,null,null,null),
	(141,1,0,1,null,0,1,'-',null),
	(142,1,0,1,null,-1.25,1.3,'-',null),
	(143,1,0,5,null,null,null,null,null),
	(144,1,0,3,null,null,null,'h',null),
	(145,1,0,5,null,null,null,'h',null),
	(146,1,0,2,null,null,null,null,null),
	(147,1,0,3,null,null,null,'h',null),
	(148,1,0,12,null,null,null,null,null),
	(152,1,0,9,null,null,null,null,null),
	(153,1,0,9,null,null,null,null,null),
	(154,1,0,6,null,null,null,null,null),
	(155,1,0,4,null,null,null,null,null),
	(156,1,0,17,null,null,null,null,null),
	(157,1,0,4,null,null,null,'g/s',null),
	(158,1,0,2,null,null,null,'kg/h',null),
	(159,1,0,9,null,null,null,null,null),
	(160,1,0,4,null,null,null,null,null),
	(161,1,0,9,null,null,null,'ppm',null),
	(162,1,0,2,null,null,null,'mg/sr',null),
	(163,1,0,9,null,null,null,'Pa',null),
	(164,1,0,4,null,null,null,null,null),
	(165,1,0,4,null,null,null,null,null),
	(166,1,0,4,null,null,null,'hm',null),
	(192,1,0,4,null,null,null,null,null),
	(0,9,0,4,null,null,null,null,null),
	(1,9,0,1,null,null,null,null,null),
	(2,9,0,17,null,null,null,null,null),
	(3,9,0,1,null,null,null,null,null),
	(4,9,0,16,null,null,null,null,null),
	(5,9,0,1,null,null,null,null,null),
	(6,9,0,16,null,null,null,null,null),
	(7,9,0,1,null,null,null,null,null),
	(8,9,0,4,null,null,null,null,null),
	(9,9,0,1,null,null,null,null,null),
	(10,9,0,20,null,null,null,null,null),
	(11,9,0,4,null,null,null,null,null),
	(10,0,0,3,null,-90,90,'°',null),
	(11,0,0,3,null,-180,180,'°',null),
	(12,0,0,2,null,0,65536,'m',1),
	(13,0,0,1,null,0,255,'km/h',1),
	(14,0,0,1,null,0,360,'°',null),
	(15,0,0,1,null,0,255,'-',1),
	(16,0,0,3,'Time from midgnight',0,86400,'s',1),
	(17,0,0,2,'Days from Unix Epoch',0,99999,'day',1),
	(32,0,0,2,'Acceleration X',-16,16,'gacc',0.000488281),
	(32,0,2,2,'Acceleration Y',-16,16,'gacc',0.000488281),
	(32,0,4,2,'Acceleration Z',-16,16,'gacc',0.000488281),
	(33,0,0,2,'Acceleration Y',-200,200,'°/s',null),
	(33,0,2,2,'rotation Y',-200,200,'°/s',null),
	(33,0,4,2,'rotation Z',-200,200,'°/s',null),
	(34,0,0,2,'magnetic X',-4800,4800,'μT',null),
	(34,0,2,2,'magnetic Y',-4800,4800,'μT',null),
	(34,0,4,2,'magnetic Z',-4800,4800,'μT',null),
	(35,0,0,2,null,-40,6496,'°C',0.1),
	(36,0,0,2,null,0,16,'V',0.000244141),
	(37,0,0,2,'orientation X',null,null,null,null),
	(37,0,2,2,'orientation Y',null,null,null,null),
	(37,0,4,2,'orientation Z',null,null,null,null),
	(129,0,0,-1,null,null,null,null,null),
	(130,0,0,-1,null,-40,6496,'°C',0.1),
	(131,0,0,-1,null,null,null,null,null),
	(0,0,0,4,null,0,4294967295,'ms',1);

drop table "CarParameterSupport";
create table "CarParameterSupport"(
	"VIN" char(17) not null references "Car"("VIN"),
	"PID" smallint not null,
	"OBD_Service" smallint not null,
	"Support" Boolean not null,
	primary key("VIN","PID","OBD_Service"),
	Constraint "FK_Car_Parameter_Support" FOREIGN KEY ("PID", "OBD_Service")
		References "Parameter" ("PID", "OBD_Service")
);
--- state ---
drop table "State" cascade;
CREATE TABLE "State" (
	"StateCode" char(2) NOT NULL primary key,
	"StateName" varchar(50) NOT NULL
);

INSERT INTO "State" VALUES
	('AL','Alabama'),
	('AK','Alaska'),
	('AZ','Arizona'),
	('AR','Arkansas'),
	('CA','California'),
	('CO','Colorado'),
	('CT','Connecticut'),
	('DE','Delaware'),
	('DC','District of Columbia'),
	('FL','Florida'),
	('GA','Georgia'),
	('HI','Hawaii'),
	('ID','Idaho'),
	('IL','Illinois'),
	('IN','Indiana'),
	('IA','Iowa'),
	('KS','Kansas'),
	('KY','Kentucky'),
	('LA','Louisiana'),
	('ME','Maine'),
	('MD','Maryland'),
	('MA','Massachusetts'),
	('MI','Michigan'),
	('MN','Minnesota'),
	('MS','Mississippi'),
	('MO','Missouri'),
	('MT','Montana'),
	('NE','Nebraska'),
	('NV','Nevada'),
	('NH','New Hampshire'),
	('NJ','New Jersey'),
	('NM','New Mexico'),
	('NY','New York'),
	('NC','North Carolina'),
	('ND','North Dakota'),
	('OH','Ohio'),
	('OK','Oklahoma'),
	('OR','Oregon'),
	('PA','Pennsylvania'),
	('PR','Puerto Rico'),
	('RI','Rhode Island'),
	('SC','South Carolina'),
	('SD','South Dakota'),
	('TN','Tennessee'),
	('TX','Texas'),
	('UT','Utah'),
	('VT','Vermont'),
	('VA','Virginia'),
	('WA','Washington'),
	('WV','West Virginia'),
	('WI','Wisconsin'),
	('WY','Wyoming');

-- City --

Drop Table "City" cascade;
Create Table "City"(
	"City" varchar(90) not null primary key,
	"StateCode" char(2) references "State"("StateCode")
);


Drop Table "GasStation" cascade;
Create Table "GasStation"(
	"GasStationID" serial not null primary key,
	"GasStationBrand" Varchar(45) not null,
	"Address" varchar(300) null,
	"City" varchar(90) not null references "City"("City")
);

Drop Table "Fueling";
Create Table "Fueling"( 
	"FuelingID" serial not null primary key,
	"VIN" char(17) not null references "Car"("VIN"),
	"Odometer" Int not null,
	"OdometerUnitID" varchar(5) not null references "Unit"("UnitID"),
	"GasStationID" int not null references "GasStation"("GasStationID")
);

Drop table "Driver" cascade;
Create Table "Driver"(
	"DriverID" varchar(2) not null primary key,
	"FirstName" varchar(45) not null,
	"LastName" varchar(45) not null
);


drop table "Trip" cascade;
create table "Trip"(
	"TripID" serial not null primary key,
	"StartOdometer" int not null,
	"EndOdometer" int not null,
	"OdometerUnitID" varchar(5) not null references "Unit"("UnitID"),
	"TripDate" Date not null,
	"TripStart" Time null,
	"TripEnd" Time null,
	"VIN" char(17) not null references "Car"("VIN"),
	"Description" varchar(1000) null,
    unique("VIN", "StartOdometer")
);
drop table "DriverTrip";
create table "DriverTrip"(
    "TripID" int not null references "Trip"("TripID"),
	"DriverID" varchar(2) not null references "Driver"("DriverID"),
    primary key("TripID", "DriverID")
);

drop table "RoadCondition" cascade;
create table "RoadCondition"("RoadCondition" varchar(45) not null primary key);

drop table "TripRoadCondition" cascade;
create table "TripRoadCondition"(
	"RoadCondition" varchar(45) not null references "RoadCondition"("RoadCondition"),
	"TripID" int not null references "Trip"("TripID"),
	primary key("RoadCondition", "TripID")
);

drop table "TripCategory" cascade;
create table "TripCategory"(
	"TripCategory" varchar(45) not null primary key
);

drop table "TripCategoryLink";
create table "TripCategoryLink"(
	"TripID" int not null references "Trip"("TripID"),
	"TripCategory" varchar(45) not null references "TripCategory"("TripCategory"),
	Primary key("TripID", "TripCategory")
);

drop table "TripLeg" cascade;
create table "TripLeg"(
	"TripLegID" serial not null primary key,
	"TripID" int null references "Trip"("TripID")
);

drop table "DataFrame" cascade;
create table "DataFrame"(
	"DataFrameID" serial not null primary key,
	"TimeOffset" double precision not null,
	"TripLegID" int not null references "TripLeg"("TripLegID")
);

drop table "RawData" cascade;
create table "RawData"(
	"DataFrameID" int not null references "DataFrame"("DataFrameID"),
	"OBD_Service" smallint not null,
	"PID" smallint not null,
	"Value" bigint not null,
	primary key("DataFrameID", "OBD_Service", "PID"),
	constraint "FK_Raw_Data_Parameter" Foreign Key ("OBD_Service", "PID")
		references "Parameter"("OBD_Service", "PID")
);

drop table "ParsedData" cascade;
create table "ParsedData" (
       "DataFrameID" int not null references "DataFrame"("DataFrameID"),
	"PID" smallint not null, 
	"OBD_Service" smallint not null,
	"byteStart" smallint not null,
	"Value" double precision not null,
	primary key("DataFrameID", "PID", "OBD_Service", "byteStart"),
	constraint "FK_ParsedData_Parameter_Byte" Foreign Key("PID", "OBD_Service", "byteStart")
	references "Parameter_Byte"("PID", "OBD_Service", "byteStart")
);
